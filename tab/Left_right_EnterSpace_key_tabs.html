<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../css/accordion.css" />
    <script src="../js/accordion.js" defer></script>
    <title>頁籤類型：以左右鍵搭配Enter鍵切換頁籤</title>
    <style>
      :root {
        --brand: #0a63ff;
        --PanelBtn: #268d8d;
        --ink: #111;
        --muted-ink: #4b5563;
        --surface: #ffffff;
        --surface-2: #d0ddf7;
        --line: #ccd2dd;
        --dline: #ecedf0;
        --focus-ring: var(--brand);
        --focus-tab: #949494;
        --radius: 12px;
        --panel-bg: #f7f7f8;
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      html,
      body {
        margin: 0;
        padding: 0;
      }

      body {
        font-family: system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans TC",
          sans-serif;
        color: var(--ink);
        background: radial-gradient(
            1200px 600px at 10% -20%,
            #e8f0ff 0,
            transparent 60%
          ),
          radial-gradient(1200px 600px at 110% 120%, #eaf7ef 0, transparent 60%),
          #f6f7fb;
        line-height: 1.6;
      }

      main {
        margin-top: 40px;
      }

      .skip-link {
        position: absolute;
        left: 12px;
        top: 0;
        transform: translateY(-150%);
        padding: 12px 16px;
        background: #fff;
        border: 2px solid var(--brand);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        text-decoration: none;
        color: var(--ink);
        font-weight: 600;
        z-index: 1000;
      }

      .skip-link:focus,
      .skip-link:focus-visible {
        transform: translateY(12px);
        outline: none;
      }

      h1 {
        text-align: center;
      }

      #tab-container {
        max-width: 980px;
        margin: 32px auto;
        padding: 24px;
        background: var(--surface);
        border: 1px solid var(--line);
        border-radius: var(--radius);
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.04);
      }

      [role="tablist"] {
        display: flex;
        gap: 8px;
        border-bottom: 1px solid var(--line);
        padding: 0 4px;
        margin: 0 0 12px 0;
      }

      [role="tab"] {
        -webkit-tap-highlight-color: transparent;
        cursor: pointer;
        border: none;
        background: transparent;
        color: var(--muted-ink);
        padding: 10px 14px;
        font-size: 16px;
        border-radius: 10px 10px 0 0;
        position: relative;
        transition: background-color 0.18s ease, color 0.18s ease;
      }

      [role="tab"]:hover {
        background: var(--surface-2);
        color: var(--ink);
      }

      [role="tab"][aria-selected="true"] {
        color: var(--ink);
      }

      [role="tab"][aria-selected="true"]::after {
        content: "";
        position: absolute;
        left: 10px;
        right: 10px;
        bottom: -1px;
        height: 4px;
        background: var(--brand);
        border-radius: 2px 2px 0 0;
      }

      [role="tab"]:focus-visible {
        outline: 1px solid var(--focus-tab);
        box-shadow: 0 0 0 1px rgba(10, 99, 255, 0.18);
      }

      [role="tabpanel"] {
        background: var(--surface);
        border: 1px solid var(--line);
        border-radius: 10px;
        padding: 16px 16px 20px;
      }

      [role="tabpanel"][hidden] {
        display: none;
      }

      h2 {
        margin: 0 0 6px 0;
        font-size: 20px;
        line-height: 1.4;
      }

      p {
        margin: 0 0 12px 0;
        color: var(--muted-ink);
      }

      .panel-button {
        -webkit-tap-highlight-color: transparent;
        padding: 10px 14px;
        font-size: 16px;
        background: var(--PanelBtn);
        color: #fff;
        border: 1px solid transparent;
        border-radius: 10px;
        cursor: pointer;
        transition: transform 0.12s ease, box-shadow 0.12s ease,
          background-color 0.18s ease;
        box-shadow: 0 2px 10px rgba(10, 99, 255, 0.22);
        display: inline-flex;
        align-items: center;
        gap: 10px;
      }

      .panel-button:hover {
        transform: translateY(-1px);
        box-shadow: 0 6px 16px rgba(10, 99, 255, 0.25);
      }

      .panel-button:focus-visible {
        outline: 3px solid var(--focus-ring);
        outline-offset: 2px;
        box-shadow: 0 0 0 6px rgba(10, 99, 255, 0.18);
      }

      .panel-button:active {
        transform: translateY(0);
      }

      .disclosure {
        border: 1px solid var(--dline);
        border-radius: 10px;
        background: var(--surface);
        overflow: hidden;
        margin-top: 12px;
        padding: 5px;
      }

      .disclosure-panel {
        border-top: 1px solid var(--line);
        background: var(--panel-bg);
        padding: 14px 16px;
      }

      .chevron {
        width: 0.75rem;
        height: 0.75rem;
        border-right: 2px solid currentColor;
        border-bottom: 2px solid currentColor;
        transform: rotate(-45deg);
        transition: transform 160ms ease;
        flex: 0 0 auto;
        margin-left: 4px;
      }

      .panel-button[aria-expanded="true"] .chevron {
        transform: rotate(45deg);
      }

      :where(.disclosure-panel) :where(a, button, input, select, textarea) {
        border-radius: 8px;
      }

      :where(.disclosure-panel)
        :where(a, button, input, select, textarea):focus-visible {
        outline: 2px solid var(--focus-ring);
        outline-offset: 2px;
      }

      .visually-hidden {
        position: absolute !important;
        width: 1px;
        height: 1px;
        overflow: hidden;
        clip: rect(1px, 1px, 1px, 1px);
        white-space: nowrap;
        border: 0;
        padding: 0;
        margin: -1px;
      }

      a {
        color: var(--brand);
        text-underline-offset: 3px;
      }

      a:focus-visible {
        outline: 3px solid var(--focus-ring);
        outline-offset: 2px;
        box-shadow: 0 0 0 6px rgba(10, 99, 255, 0.18);
      }

      @media (prefers-reduced-motion: reduce) {
        * {
          transition: none !important;
          animation: none !important;
        }
      }
    </style>
  </head>

  <body>
    <a href="#mainh1" class="skip-link">跳到主要內容區</a>
    <div class="top-link">
      <a href="#auditCode" aria-label="移至相應稽核評量碼"
        >移至相應稽核評量碼</a
      >
      <a href="#detectionItem" aria-label="移至檢測方式">移至檢測方式</a>
    </div>
    <main>
      <h1 id="mainh1">頁籤類型：以左右鍵搭配Enter鍵切換頁籤</h1>
      <div id="tab-container">
        <div
          role="tablist"
          aria-label="範例頁籤元件"
          aria-orientation="horizontal"
        >
          <button
            role="tab"
            aria-selected="true"
            aria-controls="panel-1"
            id="tab-1"
            tabindex="0"
          >
            WCAG 2.1
          </button>
          <button
            role="tab"
            aria-selected="false"
            aria-controls="panel-2"
            id="tab-2"
            tabindex="-1"
          >
            網站無障礙規範
          </button>
          <button
            role="tab"
            aria-selected="false"
            aria-controls="panel-3"
            id="tab-3"
            tabindex="-1"
          >
            網站無障礙標章
          </button>
        </div>

        <div id="panel-1" role="tabpanel" tabindex="0">
          <h2>WCAG 2.1是什麼？</h2>
          <p>
            WCAG 2.1為W3C(World Wide Web Consortium)協會的WAI(Web Accessibility
            Initiative)組織訂定的無障礙網頁內容標準相關規範2.1版。
          </p>

          <section class="disclosure" aria-labelledby="tab1-disclosure-btn">
            <button
              id="tab1-disclosure-btn"
              class="panel-button"
              type="button"
              aria-expanded="false"
              aria-controls="tab1-disclosure-panel"
              aria-describedby="tab1-disclosure-hint"
            >
              展開更多說明
              <span class="chevron" aria-hidden="true"></span>
            </button>

            <div
              id="tab1-disclosure-panel"
              class="disclosure-panel"
              role="region"
              aria-labelledby="tab1-disclosure-btn"
              hidden
            >
              <p>我國當前網站無障礙規範為網站無障礙規範(110.07)。</p>
              <p>
                參考WAI組織的WCAG 2.1(Web Content Accessibility Guidelines
                2.1)而來。
              </p>
            </div>
          </section>
        </div>

        <div
          id="panel-2"
          role="tabpanel"
          tabindex="0"
          aria-labelledby="tab-2"
          hidden
        >
          <h2>網站無障礙規範</h2>
          <p>網站無障礙規範請見：</p>
          <a
            href="https://accessibility.moda.gov.tw/Accessible/Guide/68"
            target="_blank"
            rel="noopener"
            >點擊後於新視窗打開網站無障礙規範(110.07)</a
          >
        </div>

        <div
          id="panel-3"
          role="tabpanel"
          tabindex="0"
          aria-labelledby="tab-3"
          hidden
        >
          <h2>如何獲取網站無障礙標章？</h2>
          <p>
            申請網站無障礙標章，通過檢測後，即可於無障礙網路空間服務網下載標章，並將標章張貼於網站中。
          </p>
        </div>
      </div>

      <h2 id="auditCode">相應稽核評量碼</h2>
      <div id="accordionContainer"></div>

      <a id="quickLink" href="#mainh1" aria-label="移至待檢測元件"
        >移至待檢測元件</a
      >

      <h2 id="detectionItem">檢測方式</h2>
      <div class="test-guide-container">
        <h3>檢測項目：以左右鍵搭配 Enter 鍵切換之頁籤</h3>
        <ol>
          <li>
            <p>以鍵盤焦點（Tab 鍵）遊走到頁籤。</p>
          </li>
          <li>
            <p>確認頁籤被螢幕報讀為「索引標籤」。</p>
          </li>
          <li>
            <p>以鍵盤 ← / → 鍵在各頁籤項目間移動。</p>
          </li>
          <li>
            <p>
              確認被選取的頁籤會被報讀為「索引標籤已選取」，未被選取之頁籤不可被報讀為已選取。
            </p>
          </li>
          <li>
            <p>以 Enter 鍵或空白鍵選取欲選擇的頁籤。</p>
          </li>
          <li>
            <p>選擇頁籤後，以 Tab 鍵進入對應的頁籤面板。</p>
          </li>
          <li>
            <p>
              確認進入對應面板後，面板內資訊可獲得；若面板內有互動元件，則需可操作。
            </p>
          </li>
          <li>
            <p>
              以 Shift+Tab 回到頁籤項目，選取其他頁籤，並再次確認第 (3)～(7)
              均可順利操作。
            </p>
          </li>
          <li>
            <p>
              確認頁籤組件中各元件之名稱、角色與其功能相符（例如以 ARIA
              正確揭露）。
            </p>
          </li>
          <li>
            <p>
              在不同瀏覽器中，鍵盤焦點（Tab）呈現瀏覽器預設指示樣式，或由作者指定之明確可見視覺樣式（例如雙色焦點框）。
            </p>
          </li>
          <li>
            <p>
              檢查焦點指示器：其區域至少有 1 CSS
              像素圍繞該元素，且聚焦/未聚焦狀態間有 3:1 對比；若未達
              3:1，則指示器邊線厚度需達 2 CSS 像素。
            </p>
          </li>
          <li>
            <p>確認以 Tab / Shift+Tab 可順利離開整組頁籤組件（不會困住）。</p>
          </li>
          <li>
            <p>以上檢測項目均符合則判定通過。</p>
          </li>
        </ol>
      </div>

      <a href="../index.html" class="back-to-catalog">回到目錄</a>
    </main>

    <script>
      (function () {
        var skip = document.querySelector(".skip-link");
        if (!skip) return;
        skip.addEventListener("click", function () {
          var target = document.getElementById("mainh1");
          if (!target) return;
          if (!target.hasAttribute("tabindex"))
            target.setAttribute("tabindex", "-1");
          target.focus({ preventScroll: false });
        });

        const tablist = document.querySelector('[role="tablist"]');
        const tabs = Array.from(tablist.querySelectorAll('[role="tab"]'));
        const panels = Array.from(
          document.querySelectorAll('[role="tabpanel"]')
        );

        function activateTab(tab, { setFocus = true } = {}) {
          tabs.forEach((t) => {
            t.setAttribute("aria-selected", "false");
            t.setAttribute("tabindex", "-1");
          });
          panels.forEach((p) => (p.hidden = true));

          tab.setAttribute("aria-selected", "true");
          tab.setAttribute("tabindex", "0");
          const panel = document.getElementById(
            tab.getAttribute("aria-controls")
          );
          if (panel) {
            panel.hidden = false;
          }

          if (setFocus) {
            tab.focus();
          }
        }

        function moveFocus(current, delta) {
          const i = tabs.indexOf(current);
          const next = (i + delta + tabs.length) % tabs.length;
          tabs[next].focus();
        }

        tabs.forEach((tab) => {
          tab.addEventListener("click", () =>
            activateTab(tab, { setFocus: false })
          );
        });

        tablist.addEventListener("keydown", (e) => {
          const key = e.key;
          const target = e.target;
          if (target.getAttribute("role") !== "tab") return;

          switch (key) {
            case "ArrowRight":
            case "Right":
              e.preventDefault();
              moveFocus(target, +1);
              break;
            case "ArrowLeft":
            case "Left":
              e.preventDefault();
              moveFocus(target, -1);
              break;
            case "Home":
              e.preventDefault();
              tabs[0].focus();
              break;
            case "End":
              e.preventDefault();
              tabs[tabs.length - 1].focus();
              break;
            case "Enter":
            case " ":
            case "Spacebar":
              e.preventDefault();
              activateTab(target, { setFocus: true });
              break;
          }
        });

        tabs.forEach((t, idx) => {
          t.setAttribute(
            "tabindex",
            t.getAttribute("aria-selected") === "true" ? "0" : "-1"
          );
          const p = document.getElementById(t.getAttribute("aria-controls"));
          if (p) {
            p.hidden = t.getAttribute("aria-selected") !== "true";
          }
        });

        const disclosureRoot = document.querySelector("#panel-1 .disclosure");
        if (disclosureRoot) {
          const btn = disclosureRoot.querySelector(".panel-button");
          const panel = disclosureRoot.querySelector(".disclosure-panel");

          btn.setAttribute("aria-expanded", "false");
          panel.hidden = true;

          btn.addEventListener("click", function () {
            const expanded = btn.getAttribute("aria-expanded") === "true";
            btn.setAttribute("aria-expanded", String(!expanded));
            panel.hidden = expanded;
          });

          panel.addEventListener("keydown", function (e) {
            if (e.key === "Escape") {
              btn.setAttribute("aria-expanded", "false");
              panel.hidden = true;
              btn.focus();
            }
          });

          const sync = new MutationObserver(function () {
            const isHidden = panel.hasAttribute("hidden");
            btn.setAttribute("aria-expanded", String(!isHidden));
          });
          sync.observe(panel, {
            attributes: true,
            attributeFilter: ["hidden"],
          });
        }
      })();

      const accordionData = [
        {
          title: "指引1.4：可辨識",
          content: `
      <p><strong>CS1140101E</strong> 當使用者介面元件取得焦點時，使用 CSS 變更其呈現方式。</p>
      <p>⇒ 檢測方式 (1)、(3)、(5)、(6)、(7)、(10) 通過，則此項通過。</p>
      <p><strong>GN2141100E</strong> 使用網頁作者設定的高可視焦點指示器。</p>
      <p>⇒ 檢測方式 (1)、(3)、(5)、(6)、(7)、(10)、(11) 通過，則此項通過。</p>
    `,
        },
        {
          title: "指引2.1：鍵盤可操作",
          content: `
      <p><strong>GN1210101E</strong> 確認所有功能都能透過鍵盤介面來操作。</p>
      <p>⇒ 檢測方式 (1)、(3)、(5)、(6)、(7)、(8) 全部通過，則此項通過。</p>
      <p><strong>GN1210200E</strong> 確認使用者不會困在內容中。</p>
      <p>⇒ 檢測方式 (1)、(3)、(5)、(6)、(7)、(8)、(12) 全部通過，則此項通過。</p>
    `,
        },
        {
          title: "指引2.4：可導覽",
          content: `
      <p><strong>GN1240300E</strong> 按照內容的序列及關連性來安排互動元件的放置順序。</p>
      <p>⇒ 檢測方式 (1)、(3)、(5)、(6)、(7) 通過，則此項通過。</p>
    `,
        },
        {
          title: "指引4.1：相容性",
          content: `
      <p><strong>GN1410200E</strong> 使用者介面元件應暴露名稱與角色，允許直接設定可由使用者設定的屬性，並在變更時提供通知。</p>
      <p>⇒ 檢測方式 (1)、(2)、(3)、(4)、(5)、(6)、(7)、(8)、(9) 通過，則此項通過。</p>
    `,
        },
      ];

      document.addEventListener("DOMContentLoaded", function () {
        if (typeof window.initializeAccordion === "function") {
          window.initializeAccordion("accordionContainer", accordionData);
        } else {
          console.error(
            "initializeAccordion 未載入。請確認 ../js/accordion.js 是否將函式掛到 window。"
          );
        }
      });
    </script>
  </body>
</html>

